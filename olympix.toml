# Olympix Security Analysis Configuration
# Documentation: https://olympix.github.io/ConfigOptions/

[project]
# Project identification
name = "Alphix"
description = "Uniswap V4 Dynamic Fee Hook with JIT Liquidity Rehypothecation"
version = "1.0.0"

[toolchain]
# Solidity compiler version (must match foundry.toml)
solc_version = "0.8.30"
evm_version = "cancun"

# Foundry/Forge configuration
forge_build_command = "forge build"
forge_test_command = "forge test"

[analysis]
# Analysis scope - use pattern-based matching for all source files
# Pattern-based approach ensures new files are automatically included
# Test files are still excluded via exclude_paths below
src_paths = [
    "src/**/*.sol"
]

# Exclude test files, scripts, and external dependencies from analysis
exclude_paths = [
    "test/**",
    "script/**",
    "lib/**",
    "out/**",
    "cache/**",
    "broadcast/**"
]

# Analysis depth and timeout
max_depth = 10
timeout_seconds = 1800  # 30 minutes for thorough analysis

[security]
# Security check levels
# Options: "low", "medium", "high", "critical"
min_severity = "low"

# Enable all security checks
enable_reentrancy_check = true
enable_overflow_check = true
enable_access_control_check = true
enable_gas_optimization_check = true
enable_code_quality_check = true
enable_upgradeability_check = false  # Not using upgradeable contracts

[detection]
# Vulnerability detection settings
detect_vulnerabilities = true
detect_code_smells = true
detect_gas_issues = true
detect_best_practices = true

# Specific patterns to focus on
focus_on = [
    "reentrancy",
    "access-control",
    "arithmetic",
    "gas-optimization",
    "unchecked-returns",
    "delegatecall",
    "selfdestruct",
    "tx-origin",
    "timestamp-dependence",
    "erc4626",
    "flash-accounting"
]

[reports]
# Report generation settings
output_format = "json"  # Options: "json", "markdown", "html", "sarif"
output_directory = "olympix-reports"
include_recommendations = true
include_code_snippets = true
severity_breakdown = true

# SARIF format for GitHub integration
generate_sarif = true
sarif_output = "olympix-reports/olympix.sarif"

[github]
# GitHub integration settings
enable_pr_comments = true
fail_on_high_severity = true
fail_on_critical_severity = true
comment_on_new_findings_only = true

# Severity thresholds for blocking PRs
block_on_critical = true
block_on_high = false  # Set to true for stricter enforcement
block_on_medium = false
block_on_low = false

[optimization]
# Gas optimization analysis
analyze_gas_usage = true
suggest_optimizations = true
benchmark_against_best_practices = true

# Gas limits and thresholds
max_gas_per_function = 1000000
warn_on_expensive_operations = true

[custom]
# Custom rules and patterns specific to Alphix

# Known safe patterns (won't be flagged)
safe_patterns = [
    # Ownable2Step transfer is safe
    "Ownable2Step",
    # ReentrancyGuardTransient is safe
    "ReentrancyGuardTransient",
    # ERC-4626 vault interactions are intentional
    "ERC4626",
    "IERC4626"
]

# Expected external calls (won't flag as unsafe)
# These contracts are from audited, production-ready libraries
trusted_contracts = [
    "IPoolManager",      # Uniswap V4 Core - pool manager interface (audited)
    "PoolManager",       # Uniswap V4 Core - main pool manager implementation (audited)
    "IHooks",            # Uniswap V4 Core - hook interface specification
    "AccessManager",     # OpenZeppelin v5 - access control manager (audited)
    "IERC4626",          # OpenZeppelin ERC-4626 vault interface (audited)
    "ERC4626"            # OpenZeppelin ERC-4626 vault implementation (audited)
]

# Architecture-specific settings
[custom.uniswap_v4]
# Uniswap V4 hook-specific configurations
validate_hook_permissions = true
check_dynamic_fees = true
validate_hook_returns = true

[custom.rehypothecation]
# ERC-4626 yield source checks
validate_vault_interactions = true
check_share_accounting = true
validate_deposit_withdraw_symmetry = true

[custom.access_control]
# Access control validation
require_two_step_ownership = true
validate_role_assignments = true
check_pausability = true

[custom.reentrancy]
# Reentrancy protection validation
require_reentrancy_guard = true
check_state_changes_before_calls = true
validate_checks_effects_interactions = true
